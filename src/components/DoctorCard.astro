---
// src/components/DoctorCard.astro
import type { Doctor } from '../lib/types';
import TierBadge from './TierBadge.astro';
import TypeBadge from './TypeBadge.astro';

interface Props {
  doctor: Doctor;
  showRank?: boolean;
  isFirst?: boolean;
  isLast?: boolean;
}

const { doctor, showRank = true, isFirst = false, isLast = false } = Astro.props;

// Rank styling based on position
const getRankStyle = (rank: number) => {
  if (rank === 1) return 'text-rank-gold';
  if (rank === 2) return 'text-rank-silver';
  if (rank === 3) return 'text-rank-bronze';
  return 'text-mmc-secondary';
};

const rankStyle = getRankStyle(doctor.rank || 0);
---

<a
  href={`/doctor/${doctor.id}`}
  class:list={[
    "grid grid-cols-12 gap-4 px-4 py-4 bg-white hover:bg-mmc-surface transition-colors border-b border-mmc-border items-center",
    { "rounded-b-lg border-b-0": isLast }
  ]}
>
  <!-- Rank Number -->
  <div class="col-span-1 text-center">
    {showRank && doctor.rank && (
      <span class={`font-display font-black text-2xl ${rankStyle}`}>
        {doctor.rank}
      </span>
    )}
  </div>

  <!-- Doctor Info -->
  <div class="col-span-5 md:col-span-4">
    <div class="font-semibold text-mmc-primary">
      {doctor.doctor_name || '원장'}
    </div>
    <div class="text-sm text-mmc-secondary truncate">
      {doctor.hospital_name}
    </div>
  </div>

  <!-- Details (Desktop) -->
  <div class="col-span-3 md:col-span-4 hidden md:flex items-center gap-4 text-sm text-mmc-secondary">
    <span>{doctor.specialist_type}</span>
    <span class="text-mmc-border">|</span>
    <span>{doctor.region}</span>
    <span class="text-mmc-border">|</span>
    <span>경력 {doctor.years_of_practice}년</span>
  </div>

  <!-- Tier Badge -->
  <div class="col-span-3 md:col-span-2 flex justify-center">
    <TierBadge tier={doctor.tier} size="sm" />
  </div>

  <!-- Score -->
  <div class="col-span-3 md:col-span-1 text-right">
    <span class="font-display font-bold text-xl text-mmc-primary">
      {doctor.total_score.toLocaleString()}
    </span>
  </div>
</a>

<style>
  .text-rank-gold { color: #b8860b; }
  .text-rank-silver { color: #6b7280; }
  .text-rank-bronze { color: #b45309; }
</style>
